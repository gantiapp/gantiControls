{"admdatasource":{"name":"GANTI","source":"database"},"qymparams":[{"name":"TABLE_NAME","label":"Nom de la table","defaultvalue":null,"position":1,"mandatory":true,"type":"TextType"}],"qymschedules":[],"admcomment":null,"type":"TABLE","query":"SELECT\r\n\t\tL.type,\r\n\t\tL.ctrl_in,\r\n\t\tL.bdd_in,\r\n\t\tL.table_in,\r\n\t\tL.ctrl_out,\r\n\t\tL.bdd_out,\r\n\t\tL.table_out\r\nFROM (\r\n\t-- Query schedule\r\n\tSELECT DISTINCT\r\n\t\tcase when not S.is_active then 'Scheduled query (inactive)' else 'Scheduled query' end AS type,\r\n\t\tnull AS ctrl_in,\r\n\t\tnull AS bdd_in,\r\n\t\tnull AS table_in,\r\n\t\t'[' || to_char(Q.id, '0009') || '] ' || Q.name AS ctrl_out,\r\n\t\tD.name AS bdd_out,\r\n\t\tS.table_name AS table_out\r\n\tFROM\r\n\t\tqymschedule S\r\n\t\tINNER JOIN qymquery Q ON Q.id = S.qymquery_id\r\n\t\tINNER JOIN admdatasource D ON D.id = S.datasource_id\r\n\tWHERE 1 = 1\r\n\t\tAND upper(S.table_name) LIKE '%' || upper(':TABLE_NAME:') || '%'\r\n\tUNION -- Bridge schedule\r\n\tSELECT DISTINCT\r\n\t\tcase when not S.is_active then 'Scheduled bridge (inactive)' else 'Scheduled bridge' end AS type,\r\n\t\tnull AS ctrl_in,\r\n\t\tnull AS bdd_in,\r\n\t\tnull AS table_in,\r\n\t\t'[' || to_char(Q.id, '0009') || '] ' || Q.name AS ctrl_out,\r\n\t\tD.name AS bdd_out,\r\n\t\tS.table_name AS table_out\r\n\tFROM\r\n\t\tbymschedule S\r\n\t\tINNER JOIN bymquery Q ON Q.id = S.bymquery_id\r\n\t\tINNER JOIN admdatasource D ON D.id = S.datasource_id\r\n\tWHERE 1 = 1\r\n\t\tAND upper(S.table_name) LIKE '%' || upper(':TABLE_NAME:') || '%'\r\n\tUNION -- Query select\r\n\tSELECT\r\n\t\t'Query select' AS type,\r\n\t\t'[' || to_char(Q.id, '0009') || '] ' || Q.name AS ctrl_in,\r\n\t\tD.name AS bdd_in,\r\n\t\tregexp_replace(upper(Q.query), '^.*([ \\t\\n\\r][^ \\t\\n\\r]*' || upper(':TABLE_NAME:') || '[^ \\t\\n\\r]*).*$', '\\1') AS table_in,\r\n\t\tnull AS ctrl_out,\r\n\t\tnull AS bdd_out,\r\n\t\tnull AS table_out\r\n\tFROM\r\n\t\tqymquery Q\r\n\t\tINNER JOIN admdatasource D ON D.id = Q.admdatasource_id\r\n\tWHERE 1 = 1\r\n\t\tAND upper(Q.query) LIKE '%' || upper(':TABLE_NAME:') || '%'\r\n\tUNION -- Bridge select\r\n\tSELECT\r\n\t\t'Bridge select' AS type,\r\n\t\t'[' || to_char(B.id, '0009') || '] ' || concat(B.name, ' \/ ', Q.name) AS ctrl_in,\r\n\t\tD.name AS bdd_in,\r\n\t\tregexp_replace(upper(Q.query), '^.*([ \\t\\n\\r][^ \\t\\n\\r]*' || upper(':TABLE_NAME:') || '[^ \\t\\n\\r]*).*$', '\\1') AS table_in,\r\n\t\tnull AS ctrl_out,\r\n\t\tnull AS bdd_out,\r\n\t\tnull AS table_out\r\n\tFROM\r\n\t\tbymsubquery Q\r\n\t\tINNER JOIN bymquery B ON B.id = Q.bymquery_id\r\n\t\tINNER JOIN admdatasource D ON D.id = Q.admdatasource_id\r\n\tWHERE 1 = 1\r\n\t\tAND upper(Q.query) LIKE '%' || upper(':TABLE_NAME:') || '%'\r\n\tUNION -- Badge select\r\n\tSELECT\r\n\t\tcase when not S.display then 'Badge query (inactive)' else 'Badge query' end AS type,\r\n\t\t'[' || to_char(D.id, '0009') || '] ' || concat(D.name, ' \/ ', S.businessname) AS ctrl_in,\r\n\t\tBDD.name AS bdd_in,\r\n\t\tCOALESCE(regexp_replace(upper(S.plain_sql), '^.*([ \\t\\n\\r][^ \\t\\n\\r]*' || upper(':TABLE_NAME:') || '[^ \\t\\n\\r]*).*$', '\\1'), S.name) AS table_in,\r\n\t\tnull AS ctrl_out,\r\n\t\tnull AS bdd_out,\r\n\t\tnull AS table_out\r\n\tFROM\r\n\t\tdamdataset S\r\n\t\tINNER JOIN damdomain D ON D.id = S.damdomain_id\r\n\t\tINNER JOIN admdatasource BDD ON BDD.id = S.admdatasource_id\r\n\tWHERE 1 = 1\r\n\t\tAND (upper(S.name) LIKE '%' || upper(':TABLE_NAME:') || '%'\r\n\t\t\tOR upper(S.plain_sql) LIKE '%' || upper(':TABLE_NAME:') || '%')\r\n) L\r\nORDER BY\r\n\tL.type DESC, L.ctrl_in, L.ctrl_out","route":null,"method":null,"threshold":0,"qymFields":[{"qymAlerts":[{"operator":"contains","value":"Scheduled","colortype":"info","message":null,"colorallline":false},{"operator":"contains","value":"select","colortype":"warning","message":null,"colorallline":false},{"operator":"contains","value":"Badge","colortype":"info","message":null,"colorallline":false}],"name":"type"},{"qymAlerts":[],"name":"ctrl_out"},{"qymAlerts":[],"name":"bdd_out"},{"qymAlerts":[{"operator":"is not null","value":null,"colortype":"warning","message":null,"colorallline":false}],"name":"table_out"},{"qymAlerts":[],"name":"ctrl_in"},{"qymAlerts":[],"name":"bdd_in"},{"qymAlerts":[{"operator":"is not null","value":null,"colortype":"warning","message":null,"colorallline":false}],"name":"table_in"}],"spreadsheetUrl":null,"sheetName":null,"sheetRange":null,"submenu":{"name":"Ganti","controlType":"query_manager"},"name":"GTI - table name index","description":"Recherche contr√¥le d'alimentation ou d'utilisation d'une table","roles":["ADMIN GANTI"],"exportVersion":"24.10.2","controlType":"query_manager"}